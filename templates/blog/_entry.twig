{% set title = entry.title %}
{% extends "_layout" %}


{% set featureImage = {
    mode: 'crop',
    width: 900,
    height: 600,
    quality: 90
} %}

{% block content %}

  <h1 class="text-4xl text-black font-display my-4 text-center">{{ entry.title }}</h1>

  {% if entry.featureImage | length %}
    {% for image in entry.featureImage.all() %}
      <img src="{{ image.getUrl(featureImage) }}" alt="{{ image.title }}" />
    {% endfor %}
  {% endif %}

  {% include "_includes/post-blocks" with { blocks: entry.postContent.all() } only %}
   {# display post categories #}
  {% if entry.postCategories|length %}
  <div class="border-t py-2 mb-6">
    {% for category in entry.postCategories.all() %}
      <a href="{{ category.url }}" class="inline-block border rounded px-2 py-1 text-sm">
        {{- category.title -}}
      </a>
     

    {% endfor %}
  </div>
  {% endif %}
  {# @var commentsWork \twentyfourhoursmedia\commentswork\services\CommentsWorkService #}
{% set commentsWork = craft.commentsWork.service %}

{% if not currentUser and not commentsWork.allowAnonymous(entry) %}
    <p>Anonymous commenting is not allowed. Please login.</p>
{% else %}
       
{% endif %}
<!-- Component Code -->

    <div class="flex border-blue shadow-lg p-3 border-2">
        <div class="flex flex-col items-center justify-center lg:w-1/5 md:w-1/4 mr-4">
            <div class="image">
              <img class="w-40 mb-2" src="{{ entry.getAuthor().getPhoto().getUrl() }}
">
            </div>
            <div class="icon text-center"><svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                     class="inline-block" viewBox="0 0 455.73 455.73" style="enable-background:new 0 0 455.73 455.73;" xml:space="preserve" height="35" width="35">
<path style="fill:#3A559F;" d="M0,0v455.73h242.704V279.691h-59.33v-71.864h59.33v-60.353c0-43.893,35.582-79.475,79.475-79.475
	h62.025v64.622h-44.382c-13.947,0-25.254,11.307-25.254,25.254v49.953h68.521l-9.47,71.864h-59.051V455.73H455.73V0H0z"/>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
</svg>
                <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                     class="inline-block" viewBox="0 0 455.731 455.731" style="enable-background:new 0 0 455.731 455.731;" xml:space="preserve" width="35" height="35">
<g>
	<rect x="0" y="0" style="fill:#50ABF1;" width="455.731" height="455.731"/>
    <path style="fill:#FFFFFF;" d="M60.377,337.822c30.33,19.236,66.308,30.368,104.875,30.368c108.349,0,196.18-87.841,196.18-196.18
		c0-2.705-0.057-5.39-0.161-8.067c3.919-3.084,28.157-22.511,34.098-35c0,0-19.683,8.18-38.947,10.107
		c-0.038,0-0.085,0.009-0.123,0.009c0,0,0.038-0.019,0.104-0.066c1.775-1.186,26.591-18.079,29.951-38.207
		c0,0-13.922,7.431-33.415,13.932c-3.227,1.072-6.605,2.126-10.088,3.103c-12.565-13.41-30.425-21.78-50.25-21.78
		c-38.027,0-68.841,30.805-68.841,68.803c0,5.362,0.617,10.581,1.784,15.592c-5.314-0.218-86.237-4.755-141.289-71.423
		c0,0-32.902,44.917,19.607,91.105c0,0-15.962-0.636-29.733-8.864c0,0-5.058,54.416,54.407,68.329c0,0-11.701,4.432-30.368,1.272
		c0,0,10.439,43.968,63.271,48.077c0,0-41.777,37.74-101.081,28.885L60.377,337.822z"/>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
</svg>
                <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                     viewBox="0 0 455.73 455.73" style="enable-background:new 0 0 455.73 455.73;" xml:space="preserve" width="35" height="35" class="inline-block">
<path style="fill:#DD4B39;" d="M0,0v455.73h455.73V0H0z M265.67,247.037c-7.793,51.194-45.961,80.543-95.376,80.543
	c-55.531,0-100.552-45.021-100.552-100.552c0-55.517,45.021-100.538,100.552-100.538c26.862,0,50.399,9.586,67.531,26.226
	l-28.857,28.857c-9.773-9.846-23.147-15.094-38.674-15.094c-32.688,0-59.189,27.874-59.189,60.548
	c0,32.703,26.501,59.768,59.189,59.768c27.397,0,48.144-13.243,54.129-39.758h-54.129v-40.38h95.131
	c1.142,6.506,1.72,13.315,1.72,20.37C267.144,234.025,266.638,240.69,265.67,247.037z M386.419,234.517h-35.233v35.218H326.16
	v-35.218h-35.233v-25.041h35.233v-35.233h25.026v35.233h35.233V234.517z"/>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
                    <g>
</g>
</svg>

            </div>
        </div>
        <div class="lg:w-4/5 md:w-3/4 ">
            <h1 class="text-4xl font-bold">{{ entry.author.firstName }}  </h1>
            <p class="my-2 text-base">{{ entry.author.bio}}</p>
        </div>
    </div>
  {# start comments #}
    {# you may want to put this code in an include or embed for reusability #}

    <div id="comments"><!-- anchor --></div>
    {# @var commentsWork \twentyfourhoursmedia\commentswork\services\CommentsWorkService #}
    {% set commentsWork = craft.commentsWork.service %}
    {# check if the user has just posted a comment and provide feedback #}
    {% set justPosted = commentsWork.checkJustPosted() %}

    {% if justPosted %}
        {# show a message not the form #}
        {% if justPosted.error %}
            <div class="alert alert-danger">
                <p>The comment could not be posted.</p>
            </div>
        {% else %}
            {% if justPosted.status == 'APPROVED' %}
                <div class="alert alert-success"><p>Your comment has been published.</p></div>
            {% elseif justPosted.status == 'PENDING' %}
                <div class="alert alert-warning"><p>Your comment has been posted and is awaiting moderation.</p></div>
            {% else %}
                {# the status is either trashed or spam for some reason,, #}
                <div class="alert alert-danger"><p>Your comment has been posted but has not been not published..</p>
                </div>
            {% endif %}
        {% endif %}
    {% else %}
        {# show the form #}
        {% if not currentUser and not commentsWork.allowAnonymous(entry) %}
            <p>Anonymous commenting is not allowed. Please login.</p>
        {% else %}
            <div class="card bg-light">
                <div class="card-header">
                    Leave a comment
                </div>
               
            <form  class="w-full max-w-xl bg-white rounded-lg px-7 pt-2" method="post" action="{{ url('/actions/comments-work/default/post-comment') }}">
                {{ csrfInput() }}
                {{ signCommentForm(entry) }}
                <input name="redirect" value="{{ craft.app.request.url }}#comments" type="hidden"/>
                <input name="elementId" value="{{ entry.id }}" type="hidden"/>
                <input name="siteId" value="{{ entry.siteId }}" type="hidden"/>
                <input name="commentFormat" value="text" type="hidden"/>

                <div  class="w-full md:w-full px-3 mb-2 mt-2">
                    <label for="comment-title">Title</label>
                    <input class="px-2 py-1 placeholder-blueGray-300 text-blueGray-600 relative bg-white bg-white rounded text-sm border-0 shadow outline-none focus:outline-none focus:ring w-full" name="title" id="comment-title" type="text" class="form-control"/>
                </div>
                <div class="w-full md:w-full px-3 mb-2 mt-2">
                    <label for="comment-content">Comment</label>
                    <textarea class="bg-white rounded border border-gray-400 leading-normal resize-none w-full h-20 py-2 px-3 font-medium placeholder-gray-700 focus:outline-none focus:bg-white" name="comment" rows="5" id="comment-content" class="form-control"></textarea>
                </div>

                <div>
                    <input class="bg-white text-gray-700 font-medium py-1 px-4 border border-gray-400 rounded-lg tracking-wide mr-1 hover:bg-gray-100"  type="submit"  value="Post comment"/>
                </div>
            </form>
            </div>
        {% endif %}
    {% endif %}

    {# show latest 50 comments#}
    <p>{{ commentsWork.countComments(entry) }} total comments</p>

    {% set comments = commentsWork.fetchComments(entry, 0, 50) %}
    {% for comment in comments %}
        {# @var comment \twentyfourhoursmedia\commentswork\models\CommentModel #}
        <div class="card card bg-light">
            <div class="card-body">
                <div class="row">
                    <div class="col-md-2">
                        <img src="{{ entry.getAuthor().getPhoto().getUrl() }}" class="img img-rounded img-fluid"
                             width="64">
                        <p class="text-secondary text-center">{{ comment.dateCreated | date }} {{ comment.dateCreated | date('H:i') }}</p>
                    </div>
                    <div class="col-md-10">
                        {%- if comment.user %}<p><a
                                    href="#"><strong>{{ comment.user.friendlyName }}</strong></a>
                            </p>{% endif -%}
                        {%- if comment.title is not empty %}
                            <p><strong>{{ comment.title }}</strong></p>
                        {% endif -%}
                        {%- if comment.comment is not empty %}
                            <p>
                                {{ comment | commentAsHtml }}
                            </p>
                        {% endif -%}
                    </div>
                </div>
            </div>
        </div>
        <br/>
    {% endfor %}
    {# end comments #}

</div>
  
{% endblock %}